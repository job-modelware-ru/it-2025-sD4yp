@startuml
title Диаграмма деятельности: Добавление трека (с внешним API)

|#AliceBlue|Пользователь|
start
:Вводит название трека или ссылку;
:Выбирает/подтверждает стриминг-сервис;

|#Ivory|Система|
:Сформировать запрос к API;

|#MistyRose|Внешний провайдер|
:Обработать поисковый запрос;

if (Треки найдены?) then (нет)
  |Система|
  :Показать сообщение: "Ничего не найдено";
  stop
else (да)
  |Внешний провайдер|
  :Вернуть список треков;
  note right
    Возвращает:
    - Название
    - Артист
    - Длительность
    - Обложка
  end note
endif

|Пользователь|
:Выбирает нужный трек из списка;

|Система|
:Проверить наличие трека в плейлисте;

if (Трек уже есть?) then (да)
  :Ошибка: "Трек уже добавлен";
  stop
else (нет)
  :Создать объект Track;
  :Добавить в конец общего плейлиста;
  stop
endif
@enduml